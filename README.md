
# Генерация офтальмологических препаратов с заданными свойствами

## Описание проекта

Данный проект направлен на подбор молекул (SMILES) для создания эффективных глазных капель с учетом различных физико-химических и биологических свойств. Основная цель - сократить время разработки потенциальных лекарственных средств с помощью технологий искусственного интеллекта и генеративного моделирования.

## Установка

1. **Необходимые предварительные компоненты**:
   - Anaconda (https://www.anaconda.com/download)

2. **Создание виртуального окружения**:
   ```bash
   conda create -n ophthalmic python=3.8
   conda activate ophthalmic
   conda install -c bioconda boost
   pip install -r requirements.txt
   ```

3. **Установка Reinvent4**:
   ```bash
   git clone https://github.com/MolecularAI/REINVENT4.git
   cd REINVENT4
   
   # Клонировать наш репозиторий
   mkdir temp_ophth
   cd temp_ophth
   git clone https://github.com/Eternal-insomnia/Ophthalmic-drugs.git
   cd ..
   
   # Заменить необходимые файлы
   cp -R temp_ophth/Ophthalmic-drugs/* ./
   
   # Установить дополнительные зависимости
   pip install -r requirements.txt
   ```

## Метрики оценки молекул

### Основные метрики (Primary)

1. **Проницаемость через роговицу** (corneal_metric.py)
   - Оценивает способность молекулы проходить через роговицу глаза
   - Чем выше значение, тем лучше проницаемость
   - Используются дескрипторы из RDKit, отобранные с помощью трех методов (статистический отбор, рекурсивное исключение признаков, Boruta алгоритм)
   - Случайный лес
   
2. **Связывание с меланином** (melanin_metric.py)
   - Оценивает связывание молекулы с меланином
   - 1 - есть связь, 0 - нет связи
   - Использует тот же набор дескрипторов из RDKit
   - Случайный лес

3. **Раздражение** (irritation_metric.py)
   - Оценивает потенциал раздражения глаз
   - 0 - нет раздражения, 1 - есть раздражение
   - Использует тот же набор дескрипторов из RDKit
   - Случайный лес

4. **Связывание с COX-2** (docking_utils)
   - Циклооксигеназа-2 (COX-2) - фермент, участвующий в воспалительных процессах
   - Для расчета используется AutoDock Vina - эффективный инструмент для молекулярного докинга с высокой точностью и скоростью
   - Целевые значения: от -6 до -12 (чем меньше, тем сильнее связывание)

### Дополнительные метрики (Unprimary)

1. **SAscore** - оценка синтетической доступности молекулы (насколько легко ее синтезировать)
2. **QED** - оценка соответствия молекулы характеристикам традиционных лекарств
3. **Энергия связывания** - энергетическая выгодность связывания молекулы с целевым белком
4. **Brenk** - фильтр нежелательных функциональных групп и структурных фрагментов

## Система скоринга

- **Основные метрики**: от 0 до 10 баллов за каждую
- **Дополнительные метрики**: от 0 до 1 балла за каждую
- **Общий скоринг**: от 0 до 48 баллов
- Для генеративной модели общий скоринг нормализуется в диапазон от 0 до 1 (формат float)

## Генерация молекул с помощью Reinvent

Генеративная модель Reinvent4 используется в двух режимах:

1. **staged_learning** - пошаговое обучение модели с постепенным усложнением критериев отбора
2. **sampling** - генерация молекул с использованием обученной модели

Для каждого режима предусмотрен специальный конфигурационный файл (staged_learning.toml и sampling.toml).

### Запуск генерации

**При отсутствии видеокарты**:
```bash
reinvent configs/toml/sampling.toml -d cpu
```

**При наличии видеокарты**:
```bash
reinvent configs/toml/sampling.toml
```

Результаты генерации сохраняются в файл `sampling.csv`.

## Заключительный этап

После генерации молекул производится их дополнительный отбор и ранжирование с учетом:
- Фильтра Brenk
- Четырех дополнительных метрик (SAscore, QED, энергия связывания, Brenk)

Финальным результатом работы является ранжированный список SMILES-представлений молекул с потенциалом для дальнейшей разработки офтальмологических препаратов.
